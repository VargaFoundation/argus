version: "3.8"

services:
  hiveserver2:
    image: apache/hive:4.0.0
    container_name: argus-hiveserver2
    ports:
      - "10000:10000"   # HiveServer2 Thrift
      - "10002:10002"   # HiveServer2 Web UI
    environment:
      SERVICE_NAME: hiveserver2
      IS_RESUME: "true"
      SERVICE_OPTS: >-
        -Dhive.server2.authentication=NOSASL
        -Dhive.server2.thrift.port=10000
    healthcheck:
      test: ["CMD", "beeline", "-u", "jdbc:hive2://localhost:10000", "-e", "SELECT 1"]
      interval: 10s
      timeout: 10s
      retries: 12
      start_period: 30s
